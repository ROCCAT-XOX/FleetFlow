{{ define "vehicle/details.html" }}
{{ template "head" .}}
<body class="bg-gray-50 min-h-screen flex flex-col">
{{ template "navigation" .}}

<main class="container mx-auto px-4 py-6 flex-grow">
    <!-- Breadcrumb -->
    <div class="mb-6">
        <nav class="flex" aria-label="Breadcrumb">
            <ol class="inline-flex items-center space-x-1 md:space-x-3">
                <li><a href="/dashboard" class="text-gray-700 hover:text-blue-600">Dashboard</a></li>
                <li><span class="mx-2 text-gray-500">/</span></li>
                <li><a href="/vehicles" class="text-gray-700 hover:text-blue-600">Fahrzeuge</a></li>
                <li><span class="mx-2 text-gray-500">/</span></li>
                <li class="text-gray-500">{{ .vehicle.brand }} {{ .vehicle.model }}</li>
            </ol>
        </nav>
    </div>

    <!-- Fahrzeug Header -->
    <div class="bg-white shadow rounded-lg p-6 mb-6">
        <div class="flex justify-between items-center">
            <div class="flex items-center gap-4">
                <div>
                    <h1 class="text-2xl font-bold text-gray-900">{{ .vehicle.brand }} {{ .vehicle.model }}</h1>
                    <p class="text-gray-500">{{ .vehicle.licensePlate }} • {{ .vehicle.year }}</p>
                </div>
                <img id="brand-logo" class="h-12 w-auto hidden" src="" alt="">
            </div>
            <span class="px-3 py-1 rounded-full text-sm font-semibold
            {{ if eq .vehicle.status "available" }}bg-green-100 text-green-800{{ end }}
            {{ if eq .vehicle.status "inuse" }}bg-yellow-100 text-yellow-800{{ end }}
            {{ if eq .vehicle.status "maintenance" }}bg-red-100 text-red-800{{ end }}">
            {{ if eq .vehicle.status "available" }}Verfügbar{{ end }}
            {{ if eq .vehicle.status "inuse" }}In Benutzung{{ end }}
            {{ if eq .vehicle.status "maintenance" }}In Wartung{{ end }}
            </span>
        </div>
    </div>

    <!-- Tabs als Links -->
    <div class="border-b border-gray-200 mb-6">
        <nav class="-mb-px flex space-x-8">
            <a href="?tab=basic" class="py-4 px-1 border-b-2 font-medium text-sm {{ if or (eq .tab "basic") (not .tab) }}border-blue-500 text-blue-600{{ else }}border-transparent text-gray-500 hover:text-gray-700{{ end }}">
            Grunddaten
            </a>
            <a href="?tab=usage" class="py-4 px-1 border-b-2 font-medium text-sm {{ if eq .tab "usage" }}border-blue-500 text-blue-600{{ else }}border-transparent text-gray-500 hover:text-gray-700{{ end }}">
            Nutzung
            </a>
            <a href="?tab=maintenance" class="py-4 px-1 border-b-2 font-medium text-sm {{ if eq .tab "maintenance" }}border-blue-500 text-blue-600{{ else }}border-transparent text-gray-500 hover:text-gray-700{{ end }}">
            Wartung
            </a>
            <a href="?tab=fuel" class="py-4 px-1 border-b-2 font-medium text-sm {{ if eq .tab "fuel" }}border-blue-500 text-blue-600{{ else }}border-transparent text-gray-500 hover:text-gray-700{{ end }}">
            Tankkosten
            </a>
            <a href="?tab=registration" class="py-4 px-1 border-b-2 font-medium text-sm {{ if eq .tab "registration" }}border-blue-500 text-blue-600{{ else }}border-transparent text-gray-500 hover:text-gray-700{{ end }}">
            Zulassung
            </a>
        </nav>
    </div>

    <!-- Tab Content -->
    {{ if or (eq .tab "basic") (not .tab) }}
    {{ template "vehicle/basic_info_static" . }}
    {{ else if eq .tab "usage" }}
    {{ template "vehicle/usage_static" . }}
    {{ else if eq .tab "maintenance" }}
    {{ template "vehicle/maintenance_static" . }}
    {{ else if eq .tab "fuel" }}
    {{ template "vehicle/fuel_static" . }}
    {{ else if eq .tab "registration" }}
    {{ template "vehicle/registration_static" . }}
    {{ end }}
</main>
<script>
    // Logo direkt beim Seitenladen setzen
    document.addEventListener('DOMContentLoaded', function() {
        const brandLogo = document.getElementById('brand-logo');

        // Marke aus dem H1-Element extrahieren
        const header = document.querySelector('h1.text-2xl');
        if (header && brandLogo) {
            const brand = header.textContent.split(' ')[0]; // Erstes Wort ist die Marke
            console.log('Gefundene Marke:', brand);

            if (brand) {
                // Logo-Pfad setzen
                const logoPath = `/assets/logo/${brand.toLowerCase()}.svg`;
                console.log('Versuche Logo zu laden:', logoPath);

                brandLogo.src = logoPath;
                brandLogo.alt = brand;

                brandLogo.onload = function() {
                    brandLogo.classList.remove('hidden');
                    console.log('Logo erfolgreich geladen');
                };

                brandLogo.onerror = function() {
                    console.log('SVG nicht gefunden, versuche PNG');
                    brandLogo.src = `/assets/logo/${brand.toLowerCase()}.png`;

                    brandLogo.onerror = function() {
                        console.log('Kein Logo gefunden');
                        brandLogo.classList.add('hidden');
                    };
                };
            }
        }
    });
</script>

{{ template "footer" .}}
</body>
</html>
{{ end }}