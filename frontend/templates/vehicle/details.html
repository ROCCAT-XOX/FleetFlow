{{ define "vehicle/details.html" }}
{{ template "head" .}}
<body class="bg-gray-50 min-h-screen flex flex-col">
{{ template "navigation" .}}

<main class="container mx-auto px-4 py-6 flex-grow">
    <!-- Breadcrumb -->
    <div class="mb-6">
        <nav class="flex" aria-label="Breadcrumb">
            <ol class="inline-flex items-center space-x-1 md:space-x-3">
                <li><a href="/dashboard" class="text-gray-700 hover:text-blue-600">Dashboard</a></li>
                <li><span class="mx-2 text-gray-500">/</span></li>
                <li><a href="/vehicles" class="text-gray-700 hover:text-blue-600">Fahrzeuge</a></li>
                <li><span class="mx-2 text-gray-500">/</span></li>
                <li class="text-gray-500">{{ .vehicle.brand }} {{ .vehicle.model }}</li>
            </ol>
        </nav>
    </div>

    <!-- Fahrzeug Header -->
    <div class="bg-white shadow rounded-lg p-6 mb-6">
        <div class="flex justify-between items-center">
            <div class="flex items-center gap-4">
                <div>
                    <h1 class="text-2xl font-bold text-gray-900">{{ .vehicle.brand }} {{ .vehicle.model }}</h1>
                    <p class="text-gray-500">{{ .vehicle.licensePlate }} • {{ .vehicle.year }}</p>
                </div>
                <img id="brand-logo" class="h-12 w-auto hidden" src="" alt="">
            </div>
            <span class="px-3 py-1 rounded-full text-sm font-semibold
            {{ if eq .vehicle.status "available" }}bg-green-100 text-green-800{{ end }}
            {{ if eq .vehicle.status "inuse" }}bg-yellow-100 text-yellow-800{{ end }}
            {{ if eq .vehicle.status "maintenance" }}bg-red-100 text-red-800{{ end }}">
            {{ if eq .vehicle.status "available" }}Verfügbar{{ end }}
            {{ if eq .vehicle.status "inuse" }}In Benutzung{{ end }}
            {{ if eq .vehicle.status "maintenance" }}In Wartung{{ end }}
            </span>
        </div>
    </div>

    <!-- Tab-Container -->
    <div id="vehicle-tabs-container">
        <!-- Tabs als Links -->
        <div class="border-b border-gray-200 mb-6">
            <nav class="-mb-px flex space-x-8">
                <a href="?tab=basic" class="vehicle-tab-btn py-4 px-1 border-b-2 font-medium text-sm {{ if or (eq .tab "basic") (not .tab) }}border-blue-500 text-blue-600{{ else }}border-transparent text-gray-500 hover:text-gray-700{{ end }}">
                Grunddaten
                </a>
                <a href="?tab=usage" class="vehicle-tab-btn py-4 px-1 border-b-2 font-medium text-sm {{ if eq .tab "usage" }}border-blue-500 text-blue-600{{ else }}border-transparent text-gray-500 hover:text-gray-700{{ end }}">
                Nutzung
                </a>
                <a href="?tab=maintenance" class="vehicle-tab-btn py-4 px-1 border-b-2 font-medium text-sm {{ if eq .tab "maintenance" }}border-blue-500 text-blue-600{{ else }}border-transparent text-gray-500 hover:text-gray-700{{ end }}">
                Wartung
                </a>
                <a href="?tab=fuel" class="vehicle-tab-btn py-4 px-1 border-b-2 font-medium text-sm {{ if eq .tab "fuel" }}border-blue-500 text-blue-600{{ else }}border-transparent text-gray-500 hover:text-gray-700{{ end }}">
                Tankkosten
                </a>
                <a href="?tab=registration" class="vehicle-tab-btn py-4 px-1 border-b-2 font-medium text-sm {{ if eq .tab "registration" }}border-blue-500 text-blue-600{{ else }}border-transparent text-gray-500 hover:text-gray-700{{ end }}">
                Zulassung
                </a>
                <a href="?tab=statistics" class="vehicle-tab-btn py-4 px-1 border-b-2 font-medium text-sm {{ if eq .tab "statistics" }}border-blue-500 text-blue-600{{ else }}border-transparent text-gray-500 hover:text-gray-700{{ end }}">
                Statistiken
                </a>
            </nav>
        </div>

        <!-- Tab Content -->
        <div id="tab-content">
            {{ if or (eq .tab "basic") (not .tab) }}
            {{ template "vehicle/basic_info" . }}
            {{ else if eq .tab "usage" }}
            {{ template "vehicle/current_usage" . }}
            {{ template "vehicle/usage_history" . }}
            {{ else if eq .tab "maintenance" }}
            {{ template "vehicle/maintenance" . }}
            {{ else if eq .tab "fuel" }}
            {{ template "vehicle/fuel_costs" . }}
            {{ else if eq .tab "registration" }}
            {{ template "vehicle/registration" . }}
            {{ else if eq .tab "statistics" }}
            {{ template "vehicle/statistics" . }}
            {{ end }}
        </div>
    </div>
</main>

<!-- Modals -->
{{ template "vehicle/modals" . }}

<!-- Scripts -->
<script src="/static/js/car-manufacturers.js"></script>
<script src="/static/js/vehicle-api.js"></script>
<script src="/static/js/vehicle-modals.js"></script>
<script src="/static/js/vehicle-statistics.js"></script>
<script src="/static/js/vehicle-details.js"></script>

<!-- ApexCharts für Statistiken -->
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

<script>
    // Logo direkt beim Seitenladen setzen
    document.addEventListener('DOMContentLoaded', function() {
        const brandLogo = document.getElementById('brand-logo');
        if (brandLogo) {
            const brand = '{{ .vehicle.brand }}'.toLowerCase();
            if (brand) {
                const logoPath = `/static/assets/logo/${brand}.svg`;
                brandLogo.src = logoPath;
                brandLogo.alt = '{{ .vehicle.brand }}';

                brandLogo.onload = function() {
                    brandLogo.classList.remove('hidden');
                };

                brandLogo.onerror = function() {
                    brandLogo.src = `/static/assets/logo/${brand}.png`;
                    brandLogo.onerror = function() {
                        brandLogo.classList.add('hidden');
                    };
                };
            }
        }
    });
</script>

{{ template "footer" .}}
</body>
</html>
{{ end }}